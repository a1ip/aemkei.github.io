<meta charset="utf-8">

<style>
body { width: 400px; word-wrap: break-word;}
</style>


<input id=s value="alert(1+1)">
<br>
<tt id=p>
<script>


bootstrap = 'A="",T=!A+A,L=!T+A,O=A+{},N=+A,t=T[A++],r=T[B=A],C=++B+A,D=B+B,' +
  'E=B+C,F=C+C,G=C+D,H=D+D,I=D+E,c=O[E],n=(G.A+O)[A],u=T[B],o=O[A],s=L[C],' +
  'e=T[C],X=T[P=c+o+n+s+t+r+u+c+t+o+r][P],S=" ",R="\\\\",Q="\'",M=\'"\',X(X(' +
  '(K=r+e+t+u+r+n+S)+M+X(K+X(K+M+e+s+c+(a=L[A])+(p=R+A+F+N)+e+"("+Q+"###"' +
  '+Q+")."+r+e+p+R+A+E+D+a+c+e+"(/%../"+R+A+D+G+",R)"+M)())()+M)())()';


// 146 left

start = 'ア'.charCodeAt(0);

for (i = 0; i < 9; i++) {
  input = String.fromCharCode(48 + i);
  output = String.fromCharCode(start + i);
  bootstrap = bootstrap.split(input).join(output);
}

start = 'ぁ'.charCodeAt(0);

for (i = 65; i < 122; i++) {
  input = String.fromCharCode(i);

  if (
    !(i > 90 && i<97) &&
    bootstrap.match(input)
  ) {
    output = String.fromCharCode(start);
    bootstrap = bootstrap.split(input).join(output);
    start++;
  }
}


numbers = 'NABCDEFGHI';

f = s.oninput = function(){
  o = '';

  for (i in s.value){

    char = s.value[i];

    if (char.match(/[a-z0-9]/i) || escape(char) != char){
      o += unescape(
        '%u5' +
        ('0' + char.charCodeAt(0).toString(8)).substr(-3)
      );
    } else {
      o += char;
    }
  }

  o = bootstrap.replace('###', o);

  p.innerHTML = o + '<hr>' +  o.length + ' chars<hr>' +
    encodeURIComponent(o).replace(/%[A-F\d]{2}/g, 'U').length + ' bytes'
}

f();

</script>


